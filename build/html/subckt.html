
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Subcircuits &#8212; GSEIM 0.0.1 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Block Documents" href="bedocs.html" />
    <link rel="prev" title="Solve Blocks" href="solve.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="subcircuits">
<span id="subckt"></span><h1>Subcircuits<a class="headerlink" href="#subcircuits" title="Permalink to this headline">¶</a></h1>
<p>Several circuits or systems of practical interest
involve a large number of blocks (elements). In such
cases, the schematic diagram can be significantly
simplified using subcircuits (hierarchical blocks).
In this section, we will first explain how
a simple subcircuit can be designed using the schematic
capture GUI. We will then look at more complex subcircuits,
including an induction motor model.</p>
<div class="section" id="linear-transformation">
<span id="subckt-linear2"></span><h2>Linear transformation<a class="headerlink" href="#linear-transformation" title="Permalink to this headline">¶</a></h2>
<p>Let us see how to make up a subcircuit to implement
the linear transformation given by,</p>
<div class="math notranslate nohighlight" id="equation-eq-linear">
<span class="eqno">(38)<a class="headerlink" href="#equation-eq-linear" title="Permalink to this equation">¶</a></span>\[\begin{split}\left[
\begin{array}{c}
y_1 \\
y_2
\end{array}
\right]
=
\left[
\begin{array}{cc}
a_{11} &amp; a_{12}
\\
a_{21} &amp; a_{22}
\end{array}
\right]
\thinspace
\left[
\begin{array}{c}
x_1 \\
x_2
\end{array}
\right]
\,,\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(x_1\)</span>, <span class="math notranslate nohighlight">\(x_2\)</span>
are the input nodes (variables), and
<span class="math notranslate nohighlight">\(y_1\)</span>, <span class="math notranslate nohighlight">\(y_2\)</span>
are the output nodes. Eq. <a class="reference internal" href="#equation-eq-linear">(38)</a> can be implemented
as follows.</p>
<a class="reference internal image-reference" href="_images/linear_2.png"><img alt="subckt example" src="_images/linear_2.png" style="width: 300px;" /></a>
<p>To convert this block diagram into a GSEIM subcircuit, we can use
the step-by-step procedure given below.</p>
<ul>
<li><p class="first">Start a new project. A canvas with an <code class="docutils literal notranslate"><span class="pre">Options</span></code> block will
appear. Double-click on the options block, and set <code class="docutils literal notranslate"><span class="pre">Id</span></code>
and <code class="docutils literal notranslate"><span class="pre">Title</span></code>. Note that Id should only contain letters, digits,
and the underscore character.
As a convention, it is a good idea to start <code class="docutils literal notranslate"><span class="pre">Id</span></code> with <code class="docutils literal notranslate"><span class="pre">s_</span></code>
(<code class="docutils literal notranslate"><span class="pre">s</span></code> for subcircuit); however, it is not really required.
In the <code class="docutils literal notranslate"><span class="pre">Generate</span> <span class="pre">option</span></code> field,
choose <code class="docutils literal notranslate"><span class="pre">Hier</span> <span class="pre">Block</span></code> to indicate that this schematic diagram is
for a hierarchical block (subcircuit) and not a stand-alone
system.</p>
<a class="reference internal image-reference" href="_images/sub_linear2_1.png"><img alt="options block" src="_images/sub_linear2_1.png" style="width: 550px;" /></a>
<div class="line-block">
<div class="line"><br /></div>
</div>
</li>
<li><p class="first">Save the subcircuit schematic. It is a good practice to use a file
name which reflects the name (<code class="docutils literal notranslate"><span class="pre">Id</span></code>) of the subcircuit. In our
example, it would be <code class="docutils literal notranslate"><span class="pre">s_linear_2.grc</span></code>.
The subcircuit <code class="docutils literal notranslate"><span class="pre">.grc</span></code> file can be saved in any directory; here,
we will save it in the directory where other GSEIM subcircuit
<code class="docutils literal notranslate"><span class="pre">.grc.</span></code> files are located.</p>
<a class="reference internal image-reference" href="_images/sub_linear2_9.png"><img alt="save subcircuit" src="_images/sub_linear2_9.png" style="width: 600px;" /></a>
<div class="line-block">
<div class="line"><br /></div>
</div>
</li>
<li><p class="first">The next step is to bring in the required elements (blocks)
from the library (see <a class="reference internal" href="new_project.html#new-project"><span class="std std-ref">Creating a new project</span></a>). We need four
<code class="docutils literal notranslate"><span class="pre">multscl</span></code> (multiply by scalar) elements and two <code class="docutils literal notranslate"><span class="pre">sum_2</span></code> elements.
Place the components, keeping in mind the connections we
need to make.</p>
<a class="reference internal image-reference" href="_images/sub_linear2_3.png"><img alt="placement of blocks" src="_images/sub_linear2_3.png" style="width: 130px;" /></a>
</li>
<li><p class="first">Next, we need to provide <strong>pads</strong> for our subcircuit. We need two
source pads (for
<span class="math notranslate nohighlight">\(x_1\)</span> and
<span class="math notranslate nohighlight">\(x_2\)</span>) and two
sink pads (for
<span class="math notranslate nohighlight">\(y_1\)</span> and
<span class="math notranslate nohighlight">\(y_2\)</span>). The source pads will show up as input pads when we invoke
this subcircuit from a higher level; similarly, the sink pads will show
up as output pads.
Bring in the source and sink pads from the block tree panel
<span class="math notranslate nohighlight">\(\rightarrow\)</span> <code class="docutils literal notranslate"><span class="pre">Misc</span></code>
<span class="math notranslate nohighlight">\(\rightarrow\)</span> <code class="docutils literal notranslate"><span class="pre">subcircuit</span> <span class="pre">pads</span></code>.</p>
</li>
<li><p class="first">Double-click on each of the source and sink pads and name
those as
<code class="docutils literal notranslate"><span class="pre">x1</span></code>,
<code class="docutils literal notranslate"><span class="pre">x2</span></code>,
<code class="docutils literal notranslate"><span class="pre">y1</span></code>,
<code class="docutils literal notranslate"><span class="pre">y2</span></code>.
Assign <code class="docutils literal notranslate"><span class="pre">x1</span></code> to the source pad which you brought in first,
and <code class="docutils literal notranslate"><span class="pre">x2</span></code> to the one you brought in later. Similarly, name
the sink pad you brought in first as <code class="docutils literal notranslate"><span class="pre">y1</span></code> and the other
sink pad as <code class="docutils literal notranslate"><span class="pre">y2</span></code>. When this procedure is followed, the
subcircuit, when invoked, will have the order <code class="docutils literal notranslate"><span class="pre">x1</span></code>, <code class="docutils literal notranslate"><span class="pre">x2</span></code>
for the input nodes (ports), and <code class="docutils literal notranslate"><span class="pre">y1</span></code>, <code class="docutils literal notranslate"><span class="pre">y2</span></code> for the output nodes.</p>
<a class="reference internal image-reference" href="_images/sub_linear2_5.png"><img alt="pad properties" src="_images/sub_linear2_5.png" style="width: 350px;" /></a>
<div class="line-block">
<div class="line"><br /></div>
</div>
</li>
<li><p class="first">Bring in two connectors,
<code class="docutils literal notranslate"><span class="pre">connector_f_3a</span></code> and
<code class="docutils literal notranslate"><span class="pre">connector_f_3b</span></code>, and place them suitably.
Your schematic should now look like this:</p>
<a class="reference internal image-reference" href="_images/sub_linear2_6.png"><img alt="schematic 1" src="_images/sub_linear2_6.png" style="width: 320px;" /></a>
</li>
<li><p class="first">Connect the elements as required. To make a connection between two
ports, click on one of the ports and then the other.</p>
<a class="reference internal image-reference" href="_images/sub_linear2_7.png"><img alt="schematic 2" src="_images/sub_linear2_7.png" style="width: 320px;" /></a>
</li>
<li><p class="first">Our next step is to assign the multiplier parameter (<code class="docutils literal notranslate"><span class="pre">k</span></code>)
of each <code class="docutils literal notranslate"><span class="pre">multscl</span></code> element the values shown below.</p>
<a class="reference internal image-reference" href="_images/sub_linear2_8.png"><img alt="multscl parameters" src="_images/sub_linear2_8.png" style="width: 350px;" /></a>
<div class="line-block">
<div class="line"><br /></div>
</div>
</li>
<li><p class="first">Note that we will need to make
<code class="docutils literal notranslate"><span class="pre">a11</span></code>,
<code class="docutils literal notranslate"><span class="pre">a12</span></code>,
<code class="docutils literal notranslate"><span class="pre">a21</span></code>,
<code class="docutils literal notranslate"><span class="pre">a22</span></code>
assignable when this subcircuit is invoked. This is achieved
with the help of <strong>global parameters</strong>.
Click on <code class="docutils literal notranslate"><span class="pre">GParms</span></code>
<span class="math notranslate nohighlight">\(\rightarrow\)</span>
<code class="docutils literal notranslate"><span class="pre">Add</span> <span class="pre">gparm</span></code>, and change the name as shown below.</p>
<a class="reference internal image-reference" href="_images/sub_linear2_10.png"><img alt="add gparm" src="_images/sub_linear2_10.png" style="width: 230px;" /></a>
<p>Repeat for
<code class="docutils literal notranslate"><span class="pre">a12</span></code>,
<code class="docutils literal notranslate"><span class="pre">a21</span></code>,
<code class="docutils literal notranslate"><span class="pre">a22</span></code>.</p>
</li>
<li><p class="first">We now map the global parameters to the <code class="docutils literal notranslate"><span class="pre">k</span></code> parameters of the
<code class="docutils literal notranslate"><span class="pre">multscl</span></code> elements. Double-click on the top <code class="docutils literal notranslate"><span class="pre">multscl</span></code> element
in the schematic and assign <code class="docutils literal notranslate"><span class="pre">a11</span></code> to <code class="docutils literal notranslate"><span class="pre">k</span></code>. Similarly, make
suitable assignments for the other three <code class="docutils literal notranslate"><span class="pre">multscl</span></code> elements.</p>
<a class="reference internal image-reference" href="_images/sub_linear2_11.png"><img alt="assignment of a11" src="_images/sub_linear2_11.png" style="width: 380px;" /></a>
<div class="line-block">
<div class="line"><br /></div>
</div>
</li>
<li><p class="first">Click on <code class="docutils literal notranslate"><span class="pre">Generate</span> <span class="pre">circuit</span> <span class="pre">file</span></code>. This creates a file
<code class="docutils literal notranslate"><span class="pre">~/gseim_grc/subckt/s_linear_2.hblock.yml</span></code>,
a text file which can be opened with
a text editor such as <code class="docutils literal notranslate"><span class="pre">vim</span></code>, <code class="docutils literal notranslate"><span class="pre">emacs</span></code>, <code class="docutils literal notranslate"><span class="pre">gedit</span></code>.
Notice that the <code class="docutils literal notranslate"><span class="pre">.grc</span></code> file to which we have saved the schematic
appears in the <code class="docutils literal notranslate"><span class="pre">grc_source</span></code> field in the <code class="docutils literal notranslate"><span class="pre">.yml</span></code> file.</p>
<p>End your GSEIM session and start it again. You will find the newly
added subcircuit listed under <code class="docutils literal notranslate"><span class="pre">GRC</span> <span class="pre">Hier</span> <span class="pre">Blocks</span></code> as shown below:
Note that the label which appears in this list (<code class="docutils literal notranslate"><span class="pre">s_linear_2</span></code>)
corresponds to the <code class="docutils literal notranslate"><span class="pre">Id</span></code> value we entered in the <code class="docutils literal notranslate"><span class="pre">Options</span></code> block
earlier.</p>
<a class="reference internal image-reference" href="_images/sub_linear2_12.png"><img alt="subckt menu" src="_images/sub_linear2_12.png" style="width: 200px;" /></a>
</li>
<li><p class="first">Drag and drop the subcircuit into the canvas.</p>
<p>Hovering over a port displays the name of that port.
By convention, ports corresponding to <code class="docutils literal notranslate"><span class="pre">pad_source</span></code>
blocks in the subcircuit schematic (<code class="docutils literal notranslate"><span class="pre">x1</span></code> and <code class="docutils literal notranslate"><span class="pre">x2</span></code> in our case)
appear on the left of the subcircuit symbol, and
those corresponding to <code class="docutils literal notranslate"><span class="pre">pad_sink</span></code> blocks (<code class="docutils literal notranslate"><span class="pre">y1</span></code> and <code class="docutils literal notranslate"><span class="pre">y2</span></code> in our case)
appear on the right, as shown below.</p>
<a class="reference internal image-reference" href="_images/linear_2_symbol.png"><img alt="subckt symbol" src="_images/linear_2_symbol.png" style="width: 130px;" /></a>
</li>
<li><p class="first">Double-clicking on the subcircuit opens the following dialog box,
enabling the user to edit the parameter values as required.</p>
<a class="reference internal image-reference" href="_images/sub_linear2_14.png"><img alt="Alternative text" src="_images/sub_linear2_14.png" style="width: 380px;" /></a>
</li>
</ul>
</div>
<div class="section" id="induction-motor">
<span id="subckt-indmc"></span><h2>Induction motor<a class="headerlink" href="#induction-motor" title="Permalink to this headline">¶</a></h2>
<p>We now consider the induction motor model described in
<a class="reference internal" href="templates.html#templates"><span class="std std-ref">Element Templates</span></a>. The model equations are reproduced
below.</p>
<div class="math notranslate nohighlight" id="equation-eq-indmcx-1">
<span class="eqno">(39)<a class="headerlink" href="#equation-eq-indmcx-1" title="Permalink to this equation">¶</a></span>\[\displaystyle\frac{d{\psi}_{ds}}{dt} = v_{ds}-r_si_{ds},\]</div>
<div class="math notranslate nohighlight" id="equation-eq-indmcx-2">
<span class="eqno">(40)<a class="headerlink" href="#equation-eq-indmcx-2" title="Permalink to this equation">¶</a></span>\[\displaystyle\frac{d{\psi}_{qs}}{dt} = v_{qs}-r_si_{qs},\]</div>
<div class="math notranslate nohighlight" id="equation-eq-indmcx-3">
<span class="eqno">(41)<a class="headerlink" href="#equation-eq-indmcx-3" title="Permalink to this equation">¶</a></span>\[\displaystyle\frac{d{\psi}_{dr}}{dt} = -\,\frac{P}{2}\,\omega_ {rm}\psi _{qr}-r_ri_{dr},\]</div>
<div class="math notranslate nohighlight" id="equation-eq-indmcx-4">
<span class="eqno">(42)<a class="headerlink" href="#equation-eq-indmcx-4" title="Permalink to this equation">¶</a></span>\[\displaystyle\frac{d{\psi}_{qr}}{dt} =  \frac{P}{2}\,\omega_ {rm}\psi _{dr}-r_ri_{qr},\]</div>
<div class="math notranslate nohighlight" id="equation-eq-indmcx-5">
<span class="eqno">(43)<a class="headerlink" href="#equation-eq-indmcx-5" title="Permalink to this equation">¶</a></span>\[\displaystyle\frac{d{\omega}_{rm}}{dt} = \frac{1}{J}\,(T_{em}-T_L),\]</div>
<p>where</p>
<div class="math notranslate nohighlight" id="equation-eq-indmcx1-1">
<span class="eqno">(44)<a class="headerlink" href="#equation-eq-indmcx1-1" title="Permalink to this equation">¶</a></span>\[i_{ds} = \frac{L_r}{L_m L_e}\,\psi _{ds} - \frac{1}{L_e}\,\psi _{dr},\]</div>
<div class="math notranslate nohighlight" id="equation-eq-indmcx1-2">
<span class="eqno">(45)<a class="headerlink" href="#equation-eq-indmcx1-2" title="Permalink to this equation">¶</a></span>\[i_{qs} = \frac{L_r}{L_m L_e}\,\psi _{qs} - \frac{1}{L_e}\,\psi _{qr},\]</div>
<div class="math notranslate nohighlight" id="equation-eq-indmcx1-3">
<span class="eqno">(46)<a class="headerlink" href="#equation-eq-indmcx1-3" title="Permalink to this equation">¶</a></span>\[i_{dr} = \frac{1}{L_m}\,\psi _{ds} - \left(\frac{L_{ls}}{L_m}+1\right)~i _{ds},\]</div>
<div class="math notranslate nohighlight" id="equation-eq-indmcx1-4">
<span class="eqno">(47)<a class="headerlink" href="#equation-eq-indmcx1-4" title="Permalink to this equation">¶</a></span>\[i_{qr} = \frac{1}{L_m}\,\psi _{qs} - \left(\frac{L_{ls}}{L_m}+1\right)~i _{qs},\]</div>
<div class="math notranslate nohighlight" id="equation-eq-indmcx1-5">
<span class="eqno">(48)<a class="headerlink" href="#equation-eq-indmcx1-5" title="Permalink to this equation">¶</a></span>\[T_{em} = \frac{3}{4}\, P L_m\,(i_{qs}i_{dr} - i_{ds}i_{qr}),\]</div>
<p>with</p>
<div class="math notranslate nohighlight" id="equation-eq-indmcx2-1">
<span class="eqno">(49)<a class="headerlink" href="#equation-eq-indmcx2-1" title="Permalink to this equation">¶</a></span>\[L_e = \displaystyle\frac{L_sL_r}{L_m}-L_m,\]</div>
<div class="math notranslate nohighlight" id="equation-eq-indmcx2-2">
<span class="eqno">(50)<a class="headerlink" href="#equation-eq-indmcx2-2" title="Permalink to this equation">¶</a></span>\[L_s = L_{ls}+L_m,\]</div>
<div class="math notranslate nohighlight" id="equation-eq-indmcx2-3">
<span class="eqno">(51)<a class="headerlink" href="#equation-eq-indmcx2-3" title="Permalink to this equation">¶</a></span>\[L_r = L_{lr}+L_m.\]</div>
<p>We first rewrite
Eqs. <a class="reference internal" href="#equation-eq-indmcx-1">(39)</a> to <a class="reference internal" href="#equation-eq-indmcx-5">(43)</a> such that each of them can be
implemented using basic blocks such as adder, multiplier, integrator, etc.</p>
<p>As an example, Eq. <a class="reference internal" href="#equation-eq-indmcx-3">(41)</a> can be rewritten as,</p>
<div class="math notranslate nohighlight" id="equation-eq-indmcx3-3">
<span class="eqno">(52)<a class="headerlink" href="#equation-eq-indmcx3-3" title="Permalink to this equation">¶</a></span>\[\psi _{dr} = \int \left(-\,\frac{P}{2}\,\omega _{rm}\psi _{qr}-r_r i_{dr}\right)\,dt,\]</div>
<p>which can be implemented using the <code class="docutils literal notranslate"><span class="pre">mult_2</span></code> element (to multiply <span class="math notranslate nohighlight">\(\omega _{rm}\)</span> and
<span class="math notranslate nohighlight">\(\psi _{qr}\)</span>), and the <code class="docutils literal notranslate"><span class="pre">sum\_2</span></code> and <code class="docutils literal notranslate"><span class="pre">integrator</span></code> elements described in
<a class="reference internal" href="templates.html#templates"><span class="std std-ref">Element Templates</span></a>.
Treating
Eqs. <a class="reference internal" href="#equation-eq-indmcx-1">(39)</a> to <a class="reference internal" href="#equation-eq-indmcx-5">(43)</a>
in this manner, we obtain the subciruit shown below
(the <code class="docutils literal notranslate"><span class="pre">.grc</span></code> file is
<code class="docutils literal notranslate"><span class="pre">~/gseim_grc/subckt_grc/s_indmc.grc</span></code>).</p>
<a class="reference internal image-reference" href="_images/s_indmc_annotated.png"><img alt="indmc subcircuit" src="_images/s_indmc_annotated.png" style="width: 650px;" /></a>
<p>The following additional points about the implementation may be
noted:</p>
<ul>
<li><p class="first"><strong>Virtual</strong> (dummy) sources and sinks (shown in light yellow colour) are used
in order to make wiring less cumbersome. For example, note the virtual
sink marked <code class="docutils literal notranslate"><span class="pre">&gt;idr</span></code> and the virtual source marked
<code class="docutils literal notranslate"><span class="pre">idr&gt;</span></code>, the two corresponding to the same node.</p>
</li>
<li><p class="first">Input and output pads (shown in light green colour) are used to indicate
the input and output ports of the subcircuit symbol when it is
invoked from a higher level. For the induction machine subcircuit,
<code class="docutils literal notranslate"><span class="pre">va</span></code>, <code class="docutils literal notranslate"><span class="pre">vb</span></code>, <code class="docutils literal notranslate"><span class="pre">vc</span></code>, <code class="docutils literal notranslate"><span class="pre">tl</span></code> are the input ports, and
<code class="docutils literal notranslate"><span class="pre">wrm</span></code> is the output port. When the subcircuit is invoked, the input
ports appear on the left, and the output ports on the right, as shown
below.</p>
<a class="reference internal image-reference" href="_images/indmc_symbol.png"><img alt="indmc symbol" src="_images/indmc_symbol.png" style="width: 150px;" /></a>
</li>
<li><p class="first">The subcircuit has the following parameters:
<code class="docutils literal notranslate"><span class="pre">j</span></code>,
<code class="docutils literal notranslate"><span class="pre">llr</span></code>,
<code class="docutils literal notranslate"><span class="pre">lls</span></code>,
<code class="docutils literal notranslate"><span class="pre">lm</span></code>,
<code class="docutils literal notranslate"><span class="pre">poles</span></code>,
<code class="docutils literal notranslate"><span class="pre">rr</span></code>,
<code class="docutils literal notranslate"><span class="pre">rs</span></code>,
which correspond to
<span class="math notranslate nohighlight">\(J\)</span>,
<span class="math notranslate nohighlight">\(L_{lr}\)</span>,
<span class="math notranslate nohighlight">\(L_{ls}\)</span>,
<span class="math notranslate nohighlight">\(L_m\)</span>,
<span class="math notranslate nohighlight">\(P\)</span>,
<span class="math notranslate nohighlight">\(r_r\)</span>,
<span class="math notranslate nohighlight">\(r_s\)</span>,
respectively, in
Eqs. <a class="reference internal" href="#equation-eq-indmcx-1">(39)</a> to <a class="reference internal" href="#equation-eq-indmcx-5">(43)</a>.
In implementing the equations, we need to compute quantities which
depend on these parameters.
For example, consider
Eq. <a class="reference internal" href="#equation-eq-indmcx1-1">(44)</a>
for <span class="math notranslate nohighlight">\(i_{ds}\)</span>, implemented using
the <code class="docutils literal notranslate"><span class="pre">sum\_2</span></code> element marked as <code class="docutils literal notranslate"><span class="pre">s6</span></code> in the figure. This element gives</p>
<div class="math notranslate nohighlight">
\[i_{ds} = k_1\psi _{ds} + k_2\psi _{dr},\]</div>
<p>which requires
<span class="math notranslate nohighlight">\(k_1 = \displaystyle\frac{L_r}{L_mL_e}\)</span>,
<span class="math notranslate nohighlight">\(k_2 = -\,\displaystyle\frac{1}{L_e}\)</span>
to be assigned.
For all such assignments, the user is expected to supply a python file
specific to the concerned subcircuit, and it needs to be in the
same directory as the <code class="docutils literal notranslate"><span class="pre">.yml</span></code> file for that subcircuit.
For <code class="docutils literal notranslate"><span class="pre">s_indmc</span></code>, the python file is
<code class="docutils literal notranslate"><span class="pre">~/gseim_grc/subckt/s_indmc_parm.py</span></code>, and is reproduced below.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">s_indmc_parm</span><span class="p">(</span><span class="n">dict1</span><span class="p">):</span>

    <span class="n">j</span>     <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dict1</span><span class="p">[</span><span class="s1">&#39;j&#39;</span>    <span class="p">])</span>
    <span class="n">llr</span>   <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dict1</span><span class="p">[</span><span class="s1">&#39;llr&#39;</span>  <span class="p">])</span>
    <span class="n">lls</span>   <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dict1</span><span class="p">[</span><span class="s1">&#39;lls&#39;</span>  <span class="p">])</span>
    <span class="n">lm</span>    <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dict1</span><span class="p">[</span><span class="s1">&#39;lm&#39;</span>   <span class="p">])</span>
    <span class="n">rr</span>    <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dict1</span><span class="p">[</span><span class="s1">&#39;rr&#39;</span>   <span class="p">])</span>
    <span class="n">rs</span>    <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dict1</span><span class="p">[</span><span class="s1">&#39;rs&#39;</span>   <span class="p">])</span>
    <span class="n">poles</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dict1</span><span class="p">[</span><span class="s1">&#39;poles&#39;</span><span class="p">])</span>

    <span class="n">ls</span> <span class="o">=</span> <span class="n">lls</span> <span class="o">+</span> <span class="n">lm</span>
    <span class="n">lr</span> <span class="o">=</span> <span class="n">llr</span> <span class="o">+</span> <span class="n">lm</span>
    <span class="n">le</span> <span class="o">=</span> <span class="p">(</span><span class="n">ls</span><span class="o">*</span><span class="n">lr</span><span class="o">/</span><span class="n">lm</span><span class="p">)</span> <span class="o">-</span> <span class="n">lm</span>
    <span class="n">l1</span> <span class="o">=</span> <span class="n">lr</span><span class="o">/</span><span class="p">(</span><span class="n">lm</span><span class="o">*</span><span class="n">le</span><span class="p">)</span>
    <span class="n">l2</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="p">(</span><span class="n">lls</span><span class="o">/</span><span class="n">lm</span><span class="p">)</span>
    <span class="n">l3</span> <span class="o">=</span> <span class="n">lls</span><span class="o">/</span><span class="n">lm</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="mf">0.75</span><span class="o">*</span><span class="n">poles</span><span class="o">*</span><span class="n">lm</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">poles</span>

    <span class="n">i1_k</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">j</span>

    <span class="n">s1_k1</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">s1_k2</span> <span class="o">=</span> <span class="o">-</span><span class="n">rs</span>

    <span class="n">s2_k1</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">s2_k2</span> <span class="o">=</span> <span class="o">-</span><span class="n">rs</span>

    <span class="n">s3_k1</span> <span class="o">=</span> <span class="o">-</span><span class="n">rr</span>
    <span class="n">s3_k2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>

    <span class="n">s4_k1</span> <span class="o">=</span> <span class="o">-</span><span class="n">rr</span>
    <span class="n">s4_k2</span> <span class="o">=</span>  <span class="mf">1.0</span>

    <span class="n">s6_k1</span> <span class="o">=</span> <span class="n">l1</span>
    <span class="n">s6_k2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="o">/</span><span class="n">le</span>

    <span class="n">s7_k1</span> <span class="o">=</span> <span class="n">l1</span>
    <span class="n">s7_k2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="o">/</span><span class="n">le</span>

    <span class="n">s8_k1</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">lm</span>
    <span class="n">s8_k2</span> <span class="o">=</span> <span class="o">-</span><span class="n">l2</span>

    <span class="n">s9_k1</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">lm</span>
    <span class="n">s9_k2</span> <span class="o">=</span> <span class="o">-</span><span class="n">l2</span>

    <span class="n">m1_k</span> <span class="o">=</span> <span class="n">x1</span>

    <span class="n">dict1</span><span class="p">[</span><span class="s1">&#39;i1_k&#39;</span> <span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%14.7e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i1_k</span> <span class="p">)</span>
    <span class="n">dict1</span><span class="p">[</span><span class="s1">&#39;s1_k1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%14.7e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">s1_k1</span><span class="p">)</span>
    <span class="n">dict1</span><span class="p">[</span><span class="s1">&#39;s1_k2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%14.7e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">s1_k2</span><span class="p">)</span>
    <span class="n">dict1</span><span class="p">[</span><span class="s1">&#39;s2_k1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%14.7e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">s2_k1</span><span class="p">)</span>
    <span class="n">dict1</span><span class="p">[</span><span class="s1">&#39;s2_k2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%14.7e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">s2_k2</span><span class="p">)</span>
    <span class="n">dict1</span><span class="p">[</span><span class="s1">&#39;s3_k1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%14.7e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">s3_k1</span><span class="p">)</span>
    <span class="n">dict1</span><span class="p">[</span><span class="s1">&#39;s3_k2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%14.7e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">s3_k2</span><span class="p">)</span>
    <span class="n">dict1</span><span class="p">[</span><span class="s1">&#39;s4_k1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%14.7e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">s4_k1</span><span class="p">)</span>
    <span class="n">dict1</span><span class="p">[</span><span class="s1">&#39;s4_k2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%14.7e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">s4_k2</span><span class="p">)</span>
    <span class="n">dict1</span><span class="p">[</span><span class="s1">&#39;s6_k1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%14.7e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">s6_k1</span><span class="p">)</span>
    <span class="n">dict1</span><span class="p">[</span><span class="s1">&#39;s6_k2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%14.7e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">s6_k2</span><span class="p">)</span>
    <span class="n">dict1</span><span class="p">[</span><span class="s1">&#39;s7_k1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%14.7e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">s7_k1</span><span class="p">)</span>
    <span class="n">dict1</span><span class="p">[</span><span class="s1">&#39;s7_k2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%14.7e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">s7_k2</span><span class="p">)</span>
    <span class="n">dict1</span><span class="p">[</span><span class="s1">&#39;s8_k1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%14.7e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">s8_k1</span><span class="p">)</span>
    <span class="n">dict1</span><span class="p">[</span><span class="s1">&#39;s8_k2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%14.7e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">s8_k2</span><span class="p">)</span>
    <span class="n">dict1</span><span class="p">[</span><span class="s1">&#39;s9_k1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%14.7e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">s9_k1</span><span class="p">)</span>
    <span class="n">dict1</span><span class="p">[</span><span class="s1">&#39;s9_k2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%14.7e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">s9_k2</span><span class="p">)</span>
    <span class="n">dict1</span><span class="p">[</span><span class="s1">&#39;m1_k&#39;</span> <span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%14.7e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">m1_k</span> <span class="p">)</span>
    <span class="n">dict1</span><span class="p">[</span><span class="s1">&#39;x2&#39;</span>   <span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%14.7e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x2</span>   <span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>The <code class="docutils literal notranslate"><span class="pre">k1</span></code> and <code class="docutils literal notranslate"><span class="pre">k2</span></code> values for the <code class="docutils literal notranslate"><span class="pre">sum_2</span></code> element marked as
<code class="docutils literal notranslate"><span class="pre">s6</span></code> in the schematic are computed in the above python function
as <code class="docutils literal notranslate"><span class="pre">s6_k1</span></code> and <code class="docutils literal notranslate"><span class="pre">s6_k2</span></code>, respectively. At the end of the function,
all of these computed values are stored in the parameter dictionary
for this subcircuit.
With this mechanism, the user has significant flexibility in implementing
element equations.</p>
</li>
<li><p class="first">The user can define <code class="docutils literal notranslate"><span class="pre">output</span> <span class="pre">parameters</span></code> for a subcircuit and use those at
higher levels. The output parameters
can be mapped to nodes within the subcircuit or to the output parameters
of the blocks involved in the subcircuit. These features provide a mechanism
for viewing various quantities of interest at different levels when the
system is simulated.</p>
</li>
</ul>
</div>
<div class="section" id="voltage-source-inverter">
<span id="subckt-vsi"></span><h2>Voltage source inverter<a class="headerlink" href="#voltage-source-inverter" title="Permalink to this headline">¶</a></h2>
<p>Next, we consider a subcircuit with electrical elements, viz.,
a three-phase voltage source inverter. The GSEIM implementation
is shown below.</p>
<a class="reference internal image-reference" href="_images/vsi_1.png"><img alt="three-phase VSI" src="_images/vsi_1.png" style="width: 300px;" /></a>
<p>When the subcircuit is called from a higher level,
it appears as follows.</p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/vsi_2.png"><img alt="VSI symbol" src="_images/vsi_2.png" style="width: 140px;" /></a>
</div></blockquote>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">GSEIM</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">GSEIM Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="elements.html">Blocks and ports</a></li>
<li class="toctree-l1"><a class="reference internal" href="new_project.html">Creating a new project</a></li>
<li class="toctree-l1"><a class="reference internal" href="organisation.html">GSEIM Organisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="templates.html">Element templates</a></li>
<li class="toctree-l1"><a class="reference internal" href="solve.html">Solve Blocks</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Subcircuits</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#linear-transformation">Linear transformation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#induction-motor">Induction motor</a></li>
<li class="toctree-l2"><a class="reference internal" href="#voltage-source-inverter">Voltage source inverter</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="bedocs.html">Block Documents</a></li>
<li class="toctree-l1"><a class="reference internal" href="subckt_docs.html">Sub-circuit Documents</a></li>
<li class="toctree-l1"><a class="reference internal" href="proj_list.html">GSEIM projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="mna.html">Modified nodal analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="nr.html">Newton-Raphson method</a></li>
<li class="toctree-l1"><a class="reference internal" href="numerical.html">Numerical methods for ODEs</a></li>
<li class="toctree-l1"><a class="reference internal" href="ssw.html">SSW computation</a></li>
<li class="toctree-l1"><a class="reference internal" href="startup.html">Start-up simulation</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="solve.html" title="previous chapter">Solve Blocks</a></li>
      <li>Next: <a href="bedocs.html" title="next chapter">Block Documents</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Mahesh Patil.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.8</a>
      
      |
      <a href="_sources/subckt.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>